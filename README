cmdEx: Fixes for cmd.exe
Scott Graham <scott.cmdex@h4ck3r.net>
-------------------------------------

cmdEx makes some improvements to cmd.exe. Currently:

- In PROMPT, $M displays git branch information instead of its normal function.
- Suppress "Terminate batch job (Y/N)?" prompt (prompt isn't displayed, and
  the assumed answer is always 'y').
- Improvements to input handling (set CMDEX_NOREADCONSOLE=1 to disable).
  Keybindings:
    - Alt-Up does "cd ..", maintaining current command.
    - Ctrl-W deletes back a word, Ctrl-Backspace deletes back a path
      component.
    - Alt-Left/Right or browser back/forward navigates like a web browser in
      previously visited directories, maintaining current command.
    - Improved tab completion, in addition to file and directory
      (contextually), built-ins and commands in path are completed, git
      subcommands are completed, and some git subcommands have arguments and
      context-sensitive completion (e.g. "git checkout o<TAB>" might complete
      to "git checkout origin/master"). Target names are also completed for
      the ninja build tool.
    - Ctrl-Enter opens an Explorer window in the current directory.
    - Ctrl-L clears the console and puts the current command at the top of the
      window.
    - Ctrl-D at an empty prompt exits the shell.
    - Escape clears the current line
    - Ctrl-A/Ctrl-E are the same as Home/End.
    - Ctrl-Left/Right jump by word
    - Last 1000 commands are saved to %USERPROFILE%\_cmdex_history on 'exit',
      and loaded on startup.
    - Up, Down to move through history, PgUp/F8, PgDown to complete from
      history based on current prefix.
    - Ctrl-U/Ctrl-Home delete to beginning of line, Ctrl-K/Ctrl-End delete to
      end of line.

TODO:

- Make Ctrl-V paste maybe? (possibly prompt if clipboard contains > 1 \n)
- Multiline F8 doesn't redraw properly
- I keep wanting Ctrl-Del to do something, but I'm not sure what. I think
  delete word to the right.
- Save history more often, and maybe share between instances somehow.
- Ctrl-C should do something for when killing didn't end up at a clean line.
  _CtrlCAbort@0 in cmd traps Ctrl-C right now I think, so we don't get it in
  line editor.
- Autocomplete after "set ".


cmdEx is currently only known to work on Windows 7, 8, and 8.1, and only when
using the x86 cmd.exe.


Run:

C:\...\cmdEx>out\cmdEx
[master]C:\...cmdEx>


Build:

Requires: git, svn, cmake, devenv, python in path.

With VS2012+ vars:
C:\...\cmdEx>python sng.py -u           # -u pulls third_party dependencies
C:\...\cmdEx>third_party\ninja\ninja


Test:

C:\...\cmdEx>out\tests
C:\...\cmdEx>python test.py



Acknowledgements:

- src/cmdEx/subprocess* adapted from http://github.com/martine/ninja/.

- Similar project, but readline based: http://code.google.com/p/clink/. Some
  of cmdEx's injection code is based on Clink's.
